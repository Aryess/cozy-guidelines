# Structure
Cozy Applications should follow the following structure
```coffee
build # generated by cake build
client
-  app
   -  assets
      - fonts
      - images
      | favicon.ico
   -  collections  # contains Backbone.Collections
   -  locales
      | fr.coffee ...
   -  helpers # contains all helpers functions and class
   -  models # contains Backbone.Models
      | mymodel.coffee ...
   -  styles # contains stylus files
      | _cozy.styl
      | app.styl
   -  templates # should mimic views structure
      | some_view.jade ...
   -  views # contains Backbone.Views
      | some_view.coffee ...
   |  application.coffee # initialize models, router
   |  router.coffee # Backbone.Router
- build # generated by brunch, gitignored
- tests # client tests
- vendor
  -  plugins
  -  scripts
  -  styles
- package.json
server
- controllers
  |  routes.coffee # americano style router
  |  mymodels.coffee ... # americano style controller, pluralized model name
- locales # locales used in views jade files
  |  fr.coffee ...
- helpers # contains all helpers functions and class
  |  initialize.coffee
- models
  | requests.coffe # cozydb style routes definition
  | mymodel.coffee # cozydb model
- views
  |  index.jade
  |  404.jade ...
- config.coffee # americano config
test
- fixtures # contains cozy-fixtures style fixtures
  | helpers.coffee # helpers for test suite
  | some_feature.coffee # mocha describe file
package.json
README.md
server.coffee # server, see below
```

# Difference with current status
- all apps have some `middlewares`, `helpers`, `lib` : it should be only helpers
- some apps have the index.jade in client, it should be in views/server

# About server.coffee
- server should be usable by directly calling it `coffee server.coffee`,`node build/server.js`
- server should not autostart if required from another module (test, cozy-light)
- server should respect HOST & PORT environement & bind to 127.0.0.1 by default
- try not to add logic in server.coffee (prefer to user americano beforeStart & afterStart)
- **TL;DR;** there should be a very good reason for server.coffee to be different than
```coffee
americano = apps 'americano'
application = module.exports.start = (callback) ->
    options =
        name: 'app-name'
        root: __dirname
        port: process.env.PORT || 9121
        host: process.env.HOST || '127.0.0.1'

    americano.start options, (app, server) ->
        callback? null, app, server

application() if not module.parent
```
